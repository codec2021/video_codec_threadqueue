; Listing generated by Microsoft (R) Optimizing Compiler Version 19.26.28806.0 

	TITLE	c:\users\84038\desktop\video_codec_thread_test\src\threadqueue.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB OLDNAMES

EXTRN	__imp___wassert:PROC
EXTRN	__imp__free:PROC
EXTRN	__imp__realloc:PROC
PUBLIC	_kvz_threadqueue_stop
PUBLIC	_kvz_threadqueue_free_job
PUBLIC	_kvz_threadqueue_copy_ref
PUBLIC	_kvz_threadqueue_job_dep_add
PUBLIC	_kvz_threadqueue_job_create
PUBLIC	_kvz_threadqueue_waitfor
PUBLIC	_kvz_threadqueue_submit
PUBLIC	_kvz_threadqueue_free
PUBLIC	_kvz_threadqueue_init
	ORG $+2
$SG4294966968 DB 't', 00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H
	DB	'q', 00H, 'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '-', 00H, '>'
	DB	00H, 't', 00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H
	DB	'_', 00H, 'r', 00H, 'u', 00H, 'n', 00H, 'n', 00H, 'i', 00H, 'n'
	DB	00H, 'g', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'u', 00H, 'n', 00H
	DB	't', 00H, ' ', 00H, '=', 00H, '=', 00H, ' ', 00H, '0', 00H, 00H
	DB	00H
	ORG $+2
$SG4294966969 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+2
$SG4294966987 DB 'n', 00H, 'e', 00H, 'w', 00H, '_', 00H, 'r', 00H, 'e', 00H
	DB	'f', 00H, 'c', 00H, 'o', 00H, 'u', 00H, 'n', 00H, 't', 00H, ' '
	DB	00H, '=', 00H, '=', 00H, ' ', 00H, '0', 00H, 00H, 00H
$SG4294966988 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+2
$SG4294966989 DB 'n', 00H, 'e', 00H, 'w', 00H, '_', 00H, 'r', 00H, 'e', 00H
	DB	'f', 00H, 'c', 00H, 'o', 00H, 'u', 00H, 'n', 00H, 't', 00H, ' '
	DB	00H, '>', 00H, '=', 00H, ' ', 00H, '2', 00H, 00H, 00H
$SG4294966990 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+2
$SG4294967036 DB '0', 00H, 00H, 00H
$SG4294967019 DB 'j', 00H, 'o', 00H, 'b', 00H, '-', 00H, '>', 00H, 's', 00H
	DB	't', 00H, 'a', 00H, 't', 00H, 'e', 00H, ' ', 00H, '=', 00H, '='
	DB	00H, ' ', 00H, 'T', 00H, 'H', 00H, 'R', 00H, 'E', 00H, 'A', 00H
	DB	'D', 00H, 'Q', 00H, 'U', 00H, 'E', 00H, 'U', 00H, 'E', 00H, '_'
	DB	00H, 'J', 00H, 'O', 00H, 'B', 00H, '_', 00H, 'S', 00H, 'T', 00H
	DB	'A', 00H, 'T', 00H, 'E', 00H, '_', 00H, 'P', 00H, 'A', 00H, 'U'
	DB	00H, 'S', 00H, 'E', 00H, 'D', 00H, 00H, 00H
	ORG $+2
$SG4294967020 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+2
$SG4294967030 DB 'Could not alloc job!', 0aH, 00H
	ORG $+2
$SG4294967038 DB 'pthread_mutex_lock(%s) failed!', 0aH, 00H
$SG4294967039 DB '&threadqueue->lock', 00H
	ORG $+1
$SG4294967037 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+2
$SG4294967040 DB 'Could not malloc threadqueue->threads!', 0aH, 00H
$SG4294967056 DB 'd', 00H, 'e', 00H, 'p', 00H, 'j', 00H, 'o', 00H, 'b', 00H
	DB	'-', 00H, '>', 00H, 'n', 00H, 'd', 00H, 'e', 00H, 'p', 00H, 'e'
	DB	00H, 'n', 00H, 'd', 00H, 's', 00H, ' ', 00H, '>', 00H, ' ', 00H
	DB	'0', 00H, 00H, 00H
	ORG $+2
$SG4294967057 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+6
$SG4294967058 DB 'd', 00H, 'e', 00H, 'p', 00H, 'j', 00H, 'o', 00H, 'b', 00H
	DB	'-', 00H, '>', 00H, 's', 00H, 't', 00H, 'a', 00H, 't', 00H, 'e'
	DB	00H, ' ', 00H, '=', 00H, '=', 00H, ' ', 00H, 'T', 00H, 'H', 00H
	DB	'R', 00H, 'E', 00H, 'A', 00H, 'D', 00H, 'Q', 00H, 'U', 00H, 'E'
	DB	00H, 'U', 00H, 'E', 00H, '_', 00H, 'J', 00H, 'O', 00H, 'B', 00H
	DB	'_', 00H, 'S', 00H, 'T', 00H, 'A', 00H, 'T', 00H, 'E', 00H, '_'
	DB	00H, 'W', 00H, 'A', 00H, 'I', 00H, 'T', 00H, 'I', 00H, 'N', 00H
	DB	'G', 00H, ' ', 00H, '|', 00H, '|', 00H, ' ', 00H, 'd', 00H, 'e'
	DB	00H, 'p', 00H, 'j', 00H, 'o', 00H, 'b', 00H, '-', 00H, '>', 00H
	DB	's', 00H, 't', 00H, 'a', 00H, 't', 00H, 'e', 00H, ' ', 00H, '='
	DB	00H, '=', 00H, ' ', 00H, 'T', 00H, 'H', 00H, 'R', 00H, 'E', 00H
	DB	'A', 00H, 'D', 00H, 'Q', 00H, 'U', 00H, 'E', 00H, 'U', 00H, 'E'
	DB	00H, '_', 00H, 'J', 00H, 'O', 00H, 'B', 00H, '_', 00H, 'S', 00H
	DB	'T', 00H, 'A', 00H, 'T', 00H, 'E', 00H, '_', 00H, 'P', 00H, 'A'
	DB	00H, 'U', 00H, 'S', 00H, 'E', 00H, 'D', 00H, 00H, 00H
$SG4294967059 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+6
$SG4294967068 DB 'j', 00H, 'o', 00H, 'b', 00H, '-', 00H, '>', 00H, 's', 00H
	DB	't', 00H, 'a', 00H, 't', 00H, 'e', 00H, ' ', 00H, '=', 00H, '='
	DB	00H, ' ', 00H, 'T', 00H, 'H', 00H, 'R', 00H, 'E', 00H, 'A', 00H
	DB	'D', 00H, 'Q', 00H, 'U', 00H, 'E', 00H, 'U', 00H, 'E', 00H, '_'
	DB	00H, 'J', 00H, 'O', 00H, 'B', 00H, '_', 00H, 'S', 00H, 'T', 00H
	DB	'A', 00H, 'T', 00H, 'E', 00H, '_', 00H, 'R', 00H, 'U', 00H, 'N'
	DB	00H, 'N', 00H, 'I', 00H, 'N', 00H, 'G', 00H, 00H, 00H
$SG4294967069 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+6
$SG4294967086 DB 'j', 00H, 'o', 00H, 'b', 00H, '-', 00H, '>', 00H, 's', 00H
	DB	't', 00H, 'a', 00H, 't', 00H, 'e', 00H, ' ', 00H, '=', 00H, '='
	DB	00H, ' ', 00H, 'T', 00H, 'H', 00H, 'R', 00H, 'E', 00H, 'A', 00H
	DB	'D', 00H, 'Q', 00H, 'U', 00H, 'E', 00H, 'U', 00H, 'E', 00H, '_'
	DB	00H, 'J', 00H, 'O', 00H, 'B', 00H, '_', 00H, 'S', 00H, 'T', 00H
	DB	'A', 00H, 'T', 00H, 'E', 00H, '_', 00H, 'R', 00H, 'E', 00H, 'A'
	DB	00H, 'D', 00H, 'Y', 00H, 00H, 00H
	ORG $+4
$SG4294967087 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+2
$SG4294967101 DB 't', 00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H
	DB	'q', 00H, 'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '-', 00H, '>'
	DB	00H, 'f', 00H, 'i', 00H, 'r', 00H, 's', 00H, 't', 00H, ' ', 00H
	DB	'!', 00H, '=', 00H, ' ', 00H, 'N', 00H, 'U', 00H, 'L', 00H, 'L'
	DB	00H, 00H, 00H
	ORG $+6
$SG4294967102 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
	ORG $+2
$SG4294967103 DB 'j', 00H, 'o', 00H, 'b', 00H, '-', 00H, '>', 00H, 'n', 00H
	DB	'd', 00H, 'e', 00H, 'p', 00H, 'e', 00H, 'n', 00H, 'd', 00H, 's'
	DB	00H, ' ', 00H, '=', 00H, '=', 00H, ' ', 00H, '0', 00H, 00H, 00H
	ORG $+6
$SG4294967104 DB 'C', 00H, ':', 00H, '\', 00H, 'U', 00H, 's', 00H, 'e', 00H
	DB	'r', 00H, 's', 00H, '\', 00H, '8', 00H, '4', 00H, '0', 00H, '3'
	DB	00H, '8', 00H, '\', 00H, 'D', 00H, 'e', 00H, 's', 00H, 'k', 00H
	DB	't', 00H, 'o', 00H, 'p', 00H, '\', 00H, 'v', 00H, 'i', 00H, 'd'
	DB	00H, 'e', 00H, 'o', 00H, '_', 00H, 'c', 00H, 'o', 00H, 'd', 00H
	DB	'e', 00H, 'c', 00H, '_', 00H, 't', 00H, 'h', 00H, 'r', 00H, 'e'
	DB	00H, 'a', 00H, 'd', 00H, '_', 00H, 't', 00H, 'e', 00H, 's', 00H
	DB	't', 00H, '\', 00H, 's', 00H, 'r', 00H, 'c', 00H, '\', 00H, 't'
	DB	00H, 'h', 00H, 'r', 00H, 'e', 00H, 'a', 00H, 'd', 00H, 'q', 00H
	DB	'u', 00H, 'e', 00H, 'u', 00H, 'e', 00H, '.', 00H, 'c', 00H, 00H
	DB	00H
__ehfuncinfo$_kvz_threadqueue_stop DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$_kvz_threadqueue_stop
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
__unwindtable$_kvz_threadqueue_stop DD 0ffffffffH
	DD	FLAT:___std_terminate
__ehfuncinfo$_threadqueue_worker DD 019930522H
	DD	03H
	DD	FLAT:__unwindtable$_threadqueue_worker
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
__unwindtable$_threadqueue_worker DD 0ffffffffH
	DD	FLAT:___std_terminate
	DD	0ffffffffH
	DD	FLAT:___std_terminate
	DD	0ffffffffH
	DD	FLAT:___std_terminate
__ehfuncinfo$_kvz_threadqueue_waitfor DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$_kvz_threadqueue_waitfor
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
__unwindtable$_kvz_threadqueue_waitfor DD 0ffffffffH
	DD	FLAT:___std_terminate
__ehfuncinfo$_kvz_threadqueue_free DD 019930522H
	DD	01H
	DD	FLAT:__unwindtable$_kvz_threadqueue_free
	DD	2 DUP(00H)
	DD	2 DUP(00H)
	DD	00H
	DD	01H
__unwindtable$_kvz_threadqueue_free DD 0ffffffffH
	DD	FLAT:___std_terminate
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\memory
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\memory
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\tuple
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
_kvz_threadqueue_init PROC
; _thread_count$dead$ = ecx

; 369  : {

	push	ebx
	push	ebp

; 370  :   threadqueue_queue_t *threadqueue = MALLOC(threadqueue_queue_t, 1);

	mov	ebp, DWORD PTR __imp__malloc
	push	esi
	push	edi
	push	36					; 00000024H
	call	ebp
	mov	esi, eax
	add	esp, 4

; 371  :   if (!threadqueue) {

	test	esi, esi
	je	SHORT $failed$122
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 81   :     *mutex = new std::mutex();

	push	48					; 00000030H
	call	??2@YAPAXI@Z				; operator new
	mov	edi, eax
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 40   :         _Mtx_init_in_situ(_Mymtx(), _Flags | _Mtx_try);

	push	2
	push	edi
	call	DWORD PTR __imp___Mtx_init_in_situ
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 40   :     *cond = new std::condition_variable();

	push	40					; 00000028H

; 81   :     *mutex = new std::mutex();

	mov	DWORD PTR [esi], edi

; 40   :     *cond = new std::condition_variable();

	call	??2@YAPAXI@Z				; operator new
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 578  :         _Cnd_init_in_situ(_Mycnd());

	mov	ebx, DWORD PTR __imp___Cnd_init_in_situ
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 40   :     *cond = new std::condition_variable();

	mov	edi, eax
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 578  :         _Cnd_init_in_situ(_Mycnd());

	push	edi
	call	ebx
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 40   :     *cond = new std::condition_variable();

	push	40					; 00000028H
	mov	DWORD PTR [esi+4], edi
	call	??2@YAPAXI@Z				; operator new
	mov	edi, eax
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 578  :         _Cnd_init_in_situ(_Mycnd());

	push	edi
	call	ebx
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 390  :   threadqueue->threads = MALLOC(pthread_t, thread_count);

	push	16					; 00000010H
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 40   :     *cond = new std::condition_variable();

	mov	DWORD PTR [esi+8], edi
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 390  :   threadqueue->threads = MALLOC(pthread_t, thread_count);

	call	ebp
	add	esp, 32					; 00000020H
	mov	DWORD PTR [esi+12], eax

; 391  :   if (!threadqueue->threads) {

	test	eax, eax
	jne	SHORT $LN9@kvz_thread

; 392  :     fprintf(stderr, "Could not malloc threadqueue->threads!\n");

	push	OFFSET $SG4294967040
	push	2
	call	DWORD PTR __imp____acrt_iob_func
	add	esp, 4
	push	eax
	call	_fprintf
	add	esp, 8
$failed$122:

; 416  : 
; 417  : failed:
; 418  :   kvz_threadqueue_free(threadqueue);

	mov	ecx, esi
	call	_kvz_threadqueue_free
	pop	edi

; 420  : }

	pop	esi
	pop	ebp
	xor	eax, eax
	pop	ebx
	ret	0
$LN9@kvz_thread:

; 393  :     goto failed;
; 394  :   }
; 395  :   threadqueue->thread_count = 0;
; 396  :   threadqueue->thread_running_count = 0;
; 397  : 
; 398  :   threadqueue->stop = false;
; 399  : 
; 400  :   threadqueue->first              = NULL;
; 401  :   threadqueue->last               = NULL;
; 402  : 
; 403  :   // Lock the queue before creating threads, to ensure they all have correct information.
; 404  :   PTHREAD_LOCK(&threadqueue->lock);

	mov	ecx, esi
	mov	DWORD PTR [esi+16], 0
	mov	DWORD PTR [esi+20], 0
	mov	BYTE PTR [esi+24], 0
	mov	DWORD PTR [esi+28], 0
	mov	DWORD PTR [esi+32], 0
	call	_pthread_mutex_lock
	test	eax, eax
	je	SHORT $LN10@kvz_thread
	push	OFFSET $SG4294967039
	push	OFFSET $SG4294967038
	push	2
	call	DWORD PTR __imp____acrt_iob_func
	add	esp, 4
	push	eax
	call	_fprintf
	push	404					; 00000194H
	push	OFFSET $SG4294967037
	push	OFFSET $SG4294967036
	call	DWORD PTR __imp___wassert
	add	esp, 24					; 00000018H

; 420  : }

	xor	eax, eax
	pop	edi
	pop	esi
	pop	ebp
	pop	ebx
	ret	0
$LN10@kvz_thread:

; 405  :   for (int i = 0; i < thread_count; i++) {

	xor	edi, edi
	npad	5
$LL4@kvz_thread:

; 406  :     if (pthread_create(&threadqueue->threads[i], NULL, threadqueue_worker, threadqueue) != 0) {

	mov	ebp, DWORD PTR [esi+12]
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 58   :     *thread = new std::thread(executee, arg);

	push	8
	call	??2@YAPAXI@Z				; operator new
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\memory

; 2068 :     return unique_ptr<_Ty>(new _Ty(_STD forward<_Types>(_Args)...));

	push	8
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 58   :     *thread = new std::thread(executee, arg);

	mov	ebx, eax
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\memory

; 2068 :     return unique_ptr<_Ty>(new _Ty(_STD forward<_Types>(_Args)...));

	call	??2@YAPAXI@Z				; operator new
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread

; 64   :         _Thr._Hnd =

	lea	ecx, DWORD PTR [ebx+4]
	push	ecx
	push	0
	push	eax
	push	OFFSET ??$_Invoke@V?$tuple@P6APAXPAX@ZPAX@std@@$0A@$00@thread@std@@CGIPAX@Z ; std::thread::_Invoke<std::tuple<void * (__cdecl*)(void *),void *>,0,1>
	push	0
	push	0
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\tuple

; 163  :     constexpr _Tuple_val(_Other&& _Arg) : _Val(_STD forward<_Other>(_Arg)) {}

	mov	DWORD PTR [eax], esi
	mov	DWORD PTR [eax+4], OFFSET _threadqueue_worker
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread

; 64   :         _Thr._Hnd =

	call	DWORD PTR __imp___beginthreadex
	add	esp, 32					; 00000020H
	mov	DWORD PTR [ebx], eax

; 65   :             reinterpret_cast<void*>(_CSTD _beginthreadex(nullptr, 0, _Invoker_proc, _Decay_copied.get(), 0, &_Thr._Id));
; 66   : #pragma warning(pop)
; 67   : 
; 68   :         if (_Thr._Hnd) { // ownership transferred to the thread

	test	eax, eax
	je	SHORT $LN42@kvz_thread
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 58   :     *thread = new std::thread(executee, arg);

	mov	DWORD PTR [ebp+edi], ebx
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 405  :   for (int i = 0; i < thread_count; i++) {

	add	edi, 4

; 407  :         fprintf(stderr, "pthread_create failed!\n");
; 408  :         goto failed;
; 409  :     }
; 410  :     threadqueue->thread_count++;

	inc	DWORD PTR [esi+16]

; 411  :     threadqueue->thread_running_count++;

	inc	DWORD PTR [esi+20]
	cmp	edi, 16					; 00000010H
	jl	SHORT $LL4@kvz_thread
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN110@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN110@kvz_thread:
	pop	edi
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 415  :   return threadqueue;

	mov	eax, esi

; 420  : }

	pop	esi
	pop	ebp
	pop	ebx
	ret	0
$LN42@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread

; 72   :             _Throw_Cpp_error(_RESOURCE_UNAVAILABLE_TRY_AGAIN);

	push	6
	mov	DWORD PTR [ebx+4], 0
	call	DWORD PTR __imp_?_Throw_Cpp_error@std@@YAXH@Z
$LN119@kvz_thread:
	int	3
_kvz_threadqueue_init ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
__$EHRec$ = -12						; size = 12
_kvz_threadqueue_free PROC
; _threadqueue$ = ecx

; 630  : {

	push	ebp
	mov	ebp, esp
	mov	eax, DWORD PTR fs:0
	push	-1
	push	__ehhandler$_kvz_threadqueue_free
	push	eax
	mov	DWORD PTR fs:0, esp
	push	ebx
	push	esi
	push	edi
	mov	edi, ecx

; 631  :   if (threadqueue == NULL) return;

	test	edi, edi
	je	$LN1@kvz_thread
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [edi]
	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN30@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN30@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 600  :   if (threadqueue->stop) {

	cmp	BYTE PTR [edi+24], 0
	je	SHORT $LN14@kvz_thread

; 601  :     // The threadqueue should have stopped already.
; 602  :     assert(threadqueue->thread_running_count == 0);

	cmp	DWORD PTR [edi+20], 0
	je	SHORT $LN21@kvz_thread
	push	602					; 0000025aH
	push	OFFSET $SG4294966969
	push	OFFSET $SG4294966968
	call	DWORD PTR __imp___wassert
	add	esp, 12					; 0000000cH
$LN21@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [edi]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	$LN116@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN14@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 608  :   threadqueue->stop = true;

	mov	BYTE PTR [edi+24], 1
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 592  :     void notify_all() noexcept { // wake up all waiters

	mov	DWORD PTR __$EHRec$[ebp+8], 0

; 593  :         _Check_C_return(_Cnd_broadcast(_Mycnd()));

	push	DWORD PTR [edi+4]
	call	DWORD PTR __imp___Cnd_broadcast
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN50@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN50@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 594  :     }

	mov	DWORD PTR __$EHRec$[ebp+8], -1

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [edi]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN59@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN59@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 613  :   for (int i = 0; i < threadqueue->thread_count; i++) {

	xor	ebx, ebx
	cmp	DWORD PTR [edi+16], ebx
	jle	SHORT $LN116@kvz_thread
	npad	1
$LL12@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 68   :     std::thread* real_thread = static_cast<std::thread*>(thread);

	mov	eax, DWORD PTR [edi+12]
	mov	esi, DWORD PTR [eax+ebx*4]
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread

; 101  :         return _Thr._Id != 0;

	cmp	DWORD PTR [esi+4], 0

; 105  :         if (!joinable()) {

	je	$LN117@kvz_thread

; 107  :         }
; 108  : 
; 109  :         if (_Thr._Id == _Thrd_id()) {

	call	DWORD PTR __imp___Thrd_id
	cmp	DWORD PTR [esi+4], eax
	je	$LN118@kvz_thread

; 111  :         }
; 112  : 
; 113  :         if (_Thrd_join(_Thr, nullptr) != _Thrd_success) {

	push	0
	push	DWORD PTR [esi+4]
	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Thrd_join
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	$LN119@kvz_thread
	push	8
	push	esi

; 115  :         }
; 116  : 
; 117  :         _Thr = {};

	mov	DWORD PTR [esi], eax
	mov	DWORD PTR [esi+4], eax
	call	??3@YAXPAXI@Z				; operator delete
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 613  :   for (int i = 0; i < threadqueue->thread_count; i++) {

	inc	ebx
	add	esp, 8
	cmp	ebx, DWORD PTR [edi+16]
	jl	SHORT $LL12@kvz_thread
$LN116@kvz_thread:

; 632  : 
; 633  :   kvz_threadqueue_stop(threadqueue);
; 634  : 
; 635  :   // Free all jobs.
; 636  :   while (threadqueue->first) {

	cmp	DWORD PTR [edi+28], 0
	je	SHORT $LN3@kvz_thread
$LL2@kvz_thread:

; 637  :     threadqueue_job_t *next = threadqueue->first->next;

	mov	eax, DWORD PTR [edi+28]

; 638  :     kvz_threadqueue_free_job(&threadqueue->first);

	lea	ecx, DWORD PTR [edi+28]
	mov	esi, DWORD PTR [eax+36]
	call	_kvz_threadqueue_free_job

; 639  :     threadqueue->first = next;

	mov	DWORD PTR [edi+28], esi
	test	esi, esi
	jne	SHORT $LL2@kvz_thread
$LN3@kvz_thread:

; 640  :   }
; 641  :   threadqueue->last = NULL;
; 642  : 
; 643  :   FREE_POINTER(threadqueue->threads);

	push	DWORD PTR [edi+12]
	mov	ebx, DWORD PTR __imp__free
	mov	DWORD PTR [edi+32], 0
	call	ebx
	mov	DWORD PTR [edi+12], 0
	add	esp, 4

; 644  :   threadqueue->thread_count = 0;

	mov	DWORD PTR [edi+16], 0
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 75   :     delete static_cast<std::mutex*>(*mutex);

	mov	esi, DWORD PTR [edi]
	test	esi, esi
	je	SHORT $LN90@kvz_thread
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 44   :         _Mtx_destroy_in_situ(_Mymtx());

	push	esi
	call	DWORD PTR __imp___Mtx_destroy_in_situ
	push	48					; 00000030H
	push	esi
	call	??3@YAXPAXI@Z				; operator delete
	add	esp, 12					; 0000000cH
$LN90@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 34   :     delete static_cast<std::condition_variable*>(*cond);

	mov	eax, DWORD PTR __imp___Cnd_destroy_in_situ

; 76   :     *mutex = nullptr;

	mov	DWORD PTR [edi], 0

; 34   :     delete static_cast<std::condition_variable*>(*cond);

	mov	esi, DWORD PTR [edi+4]
	test	esi, esi
	je	SHORT $LN102@kvz_thread
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 582  :         _Cnd_destroy_in_situ(_Mycnd());

	push	esi
	call	eax
	push	40					; 00000028H
	push	esi
	call	??3@YAXPAXI@Z				; operator delete
	mov	eax, DWORD PTR __imp___Cnd_destroy_in_situ
	add	esp, 12					; 0000000cH
$LN102@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 35   :     *cond = nullptr;

	mov	DWORD PTR [edi+4], 0

; 34   :     delete static_cast<std::condition_variable*>(*cond);

	mov	esi, DWORD PTR [edi+8]
	test	esi, esi
	je	SHORT $LN111@kvz_thread
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 582  :         _Cnd_destroy_in_situ(_Mycnd());

	push	esi
	call	eax
	push	40					; 00000028H
	push	esi
	call	??3@YAXPAXI@Z				; operator delete
	add	esp, 12					; 0000000cH
$LN111@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 658  :   FREE_POINTER(threadqueue);

	push	edi
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 35   :     *cond = nullptr;

	mov	DWORD PTR [edi+8], 0
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 658  :   FREE_POINTER(threadqueue);

	call	ebx
	add	esp, 4
$LN1@kvz_thread:

; 659  : }

	mov	ecx, DWORD PTR __$EHRec$[ebp]
	pop	edi
	pop	esi
	mov	DWORD PTR fs:0, ecx
	pop	ebx
	mov	esp, ebp
	pop	ebp
	ret	0
$LN119@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread

; 114  :             _Throw_Cpp_error(_NO_SUCH_PROCESS);

	push	2
	call	DWORD PTR __imp_?_Throw_Cpp_error@std@@YAXH@Z
$LN118@kvz_thread:

; 110  :             _Throw_Cpp_error(_RESOURCE_DEADLOCK_WOULD_OCCUR);

	push	5
	call	DWORD PTR __imp_?_Throw_Cpp_error@std@@YAXH@Z
$LN117@kvz_thread:

; 106  :             _Throw_Cpp_error(_INVALID_ARGUMENT);

	push	1
	call	DWORD PTR __imp_?_Throw_Cpp_error@std@@YAXH@Z
$LN129@kvz_thread:
	int	3
	int	3
	int	3
	int	3
	int	3
	int	3
_TEXT	ENDS
text$x	SEGMENT
__ehhandler$_kvz_threadqueue_free:
	npad	1
	npad	1
	mov	eax, OFFSET __ehfuncinfo$_kvz_threadqueue_free
	jmp	___CxxFrameHandler3
text$x	ENDS
_kvz_threadqueue_free ENDP
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
_kvz_threadqueue_submit PROC
; _threadqueue$ = ecx
; _job$ = edx

; 458  : {

	push	esi
	push	edi
	mov	edi, ecx
	mov	esi, edx
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [edi]
	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN21@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN21@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN31@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN31@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 461  :   assert(job->state == THREADQUEUE_JOB_STATE_PAUSED);

	cmp	DWORD PTR [esi+4], 0
	je	SHORT $LN13@kvz_thread
	push	461					; 000001cdH
	push	OFFSET $SG4294967020
	push	OFFSET $SG4294967019
	call	DWORD PTR __imp___wassert
	add	esp, 12					; 0000000cH
$LN13@kvz_thread:

; 462  : 
; 463  :   if (threadqueue->thread_count == 0) 

	cmp	DWORD PTR [edi+16], 0
	jne	SHORT $LN4@kvz_thread

; 464  :   {
; 465  :     // When not using threads, run the job immediately.
; 466  :     job->fptr(job->arg);

	push	DWORD PTR [esi+32]
	mov	eax, DWORD PTR [esi+28]
	call	eax
	add	esp, 4

; 467  :     job->state = THREADQUEUE_JOB_STATE_DONE;

	mov	DWORD PTR [esi+4], 4

; 468  :   } 

	jmp	SHORT $LN7@kvz_thread
$LN4@kvz_thread:

; 469  :   else if (job->ndepends == 0) 

	cmp	DWORD PTR [esi+8], 0
	jne	SHORT $LN6@kvz_thread

; 470  :   {
; 471  :     threadqueue_push_job(threadqueue, kvz_threadqueue_copy_ref(job));

	mov	ecx, esi
	call	_kvz_threadqueue_copy_ref
	mov	edx, eax
	mov	ecx, edi
	call	_threadqueue_push_job

; 472  :     pthread_cond_signal(&threadqueue->job_available);

	lea	ecx, DWORD PTR [edi+4]
	call	_pthread_cond_signal

; 473  :   } 

	jmp	SHORT $LN7@kvz_thread
$LN6@kvz_thread:

; 474  :   else 
; 475  :   {
; 476  :     job->state = THREADQUEUE_JOB_STATE_WAITING;

	mov	DWORD PTR [esi+4], 1
$LN7@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [esi]
	mov	esi, DWORD PTR __imp___Mtx_unlock
	call	esi
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN40@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN40@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [edi]
	call	esi
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN49@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN49@kvz_thread:
	pop	edi
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 481  :   return 1;

	mov	eax, 1

; 482  : }

	pop	esi
	ret	0
$LN53@kvz_thread:
_kvz_threadqueue_submit ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
__$EHRec$ = -12						; size = 12
_kvz_threadqueue_waitfor PROC
; _threadqueue$ = ecx
; _job$ = edx

; 578  : {

	push	ebp
	mov	ebp, esp
	mov	eax, DWORD PTR fs:0
	push	-1
	push	__ehhandler$_kvz_threadqueue_waitfor
	push	eax
	mov	DWORD PTR fs:0, esp
	push	ebx
	push	esi
	mov	esi, edx
	mov	ebx, ecx
	push	edi
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN16@kvz_thread
$LN55@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 586  : }

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN16@kvz_thread:

; 580  :   while (job->state != THREADQUEUE_JOB_STATE_DONE) {

	cmp	DWORD PTR [esi+4], 4
	je	SHORT $LN3@kvz_thread
	mov	edi, DWORD PTR __imp___Cnd_wait
$LL2@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 598  :         _Check_C_return(_Cnd_wait(_Mycnd(), _Lck.mutex()->_Mymtx()));

	push	DWORD PTR [esi]
	push	DWORD PTR [ebx+8]
	call	edi
	add	esp, 8
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	SHORT $LN55@kvz_thread
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 190  :     }

	mov	DWORD PTR __$EHRec$[ebp+8], -1
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 580  :   while (job->state != THREADQUEUE_JOB_STATE_DONE) {

	cmp	DWORD PTR [esi+4], 4
	jne	SHORT $LL2@kvz_thread
$LN3@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN50@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN50@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 586  : }

	mov	ecx, DWORD PTR __$EHRec$[ebp]
	mov	eax, 1
	pop	edi
	pop	esi
	mov	DWORD PTR fs:0, ecx
	pop	ebx
	mov	esp, ebp
	pop	ebp
	ret	0
$LN61@kvz_thread:
	int	3
	int	3
	int	3
	int	3
	int	3
_TEXT	ENDS
text$x	SEGMENT
__ehhandler$_kvz_threadqueue_waitfor:
	npad	1
	npad	1
	mov	eax, OFFSET __ehfuncinfo$_kvz_threadqueue_waitfor
	jmp	___CxxFrameHandler3
text$x	ENDS
_kvz_threadqueue_waitfor ENDP
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
_kvz_threadqueue_job_create PROC
; _fptr$dead$ = ecx
; _arg$ = edx

; 432  : {

	push	ebx
	push	edi

; 433  :   threadqueue_job_t *job = MALLOC(threadqueue_job_t, 1);

	push	40					; 00000028H
	mov	ebx, edx
	call	DWORD PTR __imp__malloc
	mov	edi, eax
	add	esp, 4

; 434  :   if (!job) {

	test	edi, edi
	jne	SHORT $LN2@kvz_thread

; 435  :     fprintf(stderr, "Could not alloc job!\n");

	push	OFFSET $SG4294967030
	push	2
	call	DWORD PTR __imp____acrt_iob_func
	add	esp, 4
	push	eax
	call	_fprintf
	add	esp, 8

; 436  :     return NULL;

	xor	eax, eax
	pop	edi

; 454  : }

	pop	ebx
	ret	0
$LN2@kvz_thread:
	push	esi
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 81   :     *mutex = new std::mutex();

	push	48					; 00000030H
	call	??2@YAPAXI@Z				; operator new
	mov	esi, eax
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 40   :         _Mtx_init_in_situ(_Mymtx(), _Flags | _Mtx_try);

	push	2
	push	esi
	call	DWORD PTR __imp___Mtx_init_in_situ
	add	esp, 12					; 0000000cH
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 81   :     *mutex = new std::mutex();

	mov	DWORD PTR [edi], esi
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 451  :   job->arg            = arg;

	mov	DWORD PTR [edi+32], ebx

; 452  : 
; 453  :   return job;

	mov	eax, edi
	mov	DWORD PTR [edi+4], 0
	mov	DWORD PTR [edi+8], 0
	pop	esi
	mov	DWORD PTR [edi+12], 0
	mov	DWORD PTR [edi+16], 0
	mov	DWORD PTR [edi+20], 0
	mov	DWORD PTR [edi+24], 1
	mov	DWORD PTR [edi+28], OFFSET _task_test
	pop	edi

; 454  : }

	pop	ebx
	ret	0
_kvz_threadqueue_job_create ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
_threadqueue_push_job PROC
; _threadqueue$ = ecx
; _job$ = edx

; 240  : {

	push	esi
	mov	esi, edx
	push	edi
	mov	edi, ecx

; 241  :   assert(job->ndepends == 0);

	cmp	DWORD PTR [esi+8], 0
	je	SHORT $LN5@threadqueu
	push	241					; 000000f1H
	push	OFFSET $SG4294967104
	push	OFFSET $SG4294967103
	call	DWORD PTR __imp___wassert
	add	esp, 12					; 0000000cH
$LN5@threadqueu:

; 242  :   job->state = THREADQUEUE_JOB_STATE_READY;

	mov	DWORD PTR [esi+4], 2

; 243  : 
; 244  :   if (threadqueue->first == NULL) //如果没有job转备好

	cmp	DWORD PTR [edi+28], 0
	jne	SHORT $LN2@threadqueu

; 245  :   {
; 246  :     threadqueue->first = job;

	mov	DWORD PTR [edi+28], esi

; 251  :   }
; 252  : 
; 253  :   threadqueue->last = job;
; 254  :   job->next = NULL;
; 255  : }

	mov	DWORD PTR [edi+32], esi
	pop	edi
	mov	DWORD PTR [esi+36], 0
	pop	esi
	ret	0
$LN2@threadqueu:

; 247  :   } 
; 248  :   else 
; 249  :   {
; 250  :     threadqueue->last->next = job;//尾插法

	mov	eax, DWORD PTR [edi+32]
	mov	DWORD PTR [eax+36], esi

; 251  :   }
; 252  : 
; 253  :   threadqueue->last = job;
; 254  :   job->next = NULL;
; 255  : }

	mov	DWORD PTR [edi+32], esi
	pop	edi
	mov	DWORD PTR [esi+36], 0
	pop	esi
	ret	0
_threadqueue_push_job ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
_threadqueue_pop_job PROC
; _threadqueue$ = ecx

; 265  : {

	push	esi
	mov	esi, ecx

; 266  :   assert(threadqueue->first != NULL);

	mov	eax, DWORD PTR [esi+28]
	test	eax, eax
	jne	SHORT $LN4@threadqueu
	push	266					; 0000010aH
	push	OFFSET $SG4294967102
	push	OFFSET $SG4294967101
	call	DWORD PTR __imp___wassert
	mov	eax, DWORD PTR [esi+28]
	add	esp, 12					; 0000000cH
$LN4@threadqueu:

; 267  : 
; 268  :   threadqueue_job_t *job = threadqueue->first;
; 269  :   threadqueue->first = job->next;

	mov	ecx, DWORD PTR [eax+36]
	mov	DWORD PTR [esi+28], ecx

; 270  :   job->next = NULL;

	mov	DWORD PTR [eax+36], 0

; 271  : 
; 272  :   if (threadqueue->first == NULL) {

	cmp	DWORD PTR [esi+28], 0
	jne	SHORT $LN2@threadqueu

; 273  :     threadqueue->last = NULL;

	mov	DWORD PTR [esi+32], 0
$LN2@threadqueu:
	pop	esi

; 274  :   }
; 275  : 
; 276  :   return job;
; 277  : }

	ret	0
_threadqueue_pop_job ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
_job$2 = -24						; size = 4
tv1080 = -20						; size = 4
_i$1$ = -16						; size = 4
__$EHRec$ = -12						; size = 12
_num_new_jobs$1$ = 8					; size = 4
_threadqueue_opaque$ = 8				; size = 4
_threadqueue_worker PROC

; 284  : {

	push	ebp
	mov	ebp, esp
	mov	eax, DWORD PTR fs:0
	push	-1
	push	__ehhandler$_threadqueue_worker
	push	eax
	mov	DWORD PTR fs:0, esp
	sub	esp, 12					; 0000000cH
	push	ebx
	push	esi
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 86   :     static_cast<std::mutex*>(*mutex)->lock();

	mov	esi, DWORD PTR _threadqueue_opaque$[ebp]
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 284  : {

	push	edi
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LL243@threadqueu
$LN196@threadqueu:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 360  : }

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
	npad	9
$LL243@threadqueu:

; 291  :     while (!threadqueue->stop && threadqueue->first == NULL) {

	cmp	BYTE PTR [esi+24], 0
	mov	edi, DWORD PTR __imp___wassert
	jne	SHORT $LN204@threadqueu
	npad	4
$LL5@threadqueu:
	cmp	DWORD PTR [esi+28], 0
	jne	SHORT $LN241@threadqueu
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 598  :         _Check_C_return(_Cnd_wait(_Mycnd(), _Lck.mutex()->_Mymtx()));

	push	DWORD PTR [esi]
	push	DWORD PTR [esi+4]
	call	DWORD PTR __imp___Cnd_wait
	add	esp, 8
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	SHORT $LN196@threadqueu
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 190  :     }

	mov	DWORD PTR __$EHRec$[ebp+8], -1
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 291  :     while (!threadqueue->stop && threadqueue->first == NULL) {

	cmp	BYTE PTR [esi+24], al
	je	SHORT $LL5@threadqueu
$LN204@threadqueu:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [esi]
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 357  :   threadqueue->thread_running_count--;

	dec	DWORD PTR [esi+20]
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	$LN187@threadqueu

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN241@threadqueu:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 266  :   assert(threadqueue->first != NULL);

	mov	ebx, DWORD PTR [esi+28]
	test	ebx, ebx
	jne	SHORT $LN81@threadqueu
	push	266					; 0000010aH
	push	OFFSET $SG4294967102
	push	OFFSET $SG4294967101
	call	edi
	mov	ebx, DWORD PTR [esi+28]
	add	esp, 12					; 0000000cH
$LN81@threadqueu:

; 267  : 
; 268  :   threadqueue_job_t *job = threadqueue->first;
; 269  :   threadqueue->first = job->next;

	mov	eax, DWORD PTR [ebx+36]
	mov	DWORD PTR [esi+28], eax

; 270  :   job->next = NULL;

	mov	DWORD PTR [ebx+36], 0

; 271  : 
; 272  :   if (threadqueue->first == NULL) {

	cmp	DWORD PTR [esi+28], 0
	jne	SHORT $LN79@threadqueu

; 273  :     threadqueue->last = NULL;

	mov	DWORD PTR [esi+32], 0
$LN79@threadqueu:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [ebx]
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 303  :     threadqueue_job_t *job = threadqueue_pop_job(threadqueue);

	mov	DWORD PTR _job$2[ebp], ebx
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 306  :     assert(job->state == THREADQUEUE_JOB_STATE_READY);

	cmp	DWORD PTR [ebx+4], 2
	je	SHORT $LN31@threadqueu
	push	306					; 00000132H
	push	OFFSET $SG4294967087
	push	OFFSET $SG4294967086
	call	edi
	add	esp, 12					; 0000000cH
$LN31@threadqueu:

; 307  :     job->state = THREADQUEUE_JOB_STATE_RUNNING;

	mov	DWORD PTR [ebx+4], 3
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [ebx]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 311  :     job->fptr(job->arg);

	push	DWORD PTR [ebx+32]
	mov	eax, DWORD PTR [ebx+28]
	call	eax
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [ebx]
	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 315  :     assert(job->state == THREADQUEUE_JOB_STATE_RUNNING);

	cmp	DWORD PTR [ebx+4], 3
	je	SHORT $LN36@threadqueu
	push	315					; 0000013bH
	push	OFFSET $SG4294967069
	push	OFFSET $SG4294967068
	call	edi
	add	esp, 12					; 0000000cH
$LN36@threadqueu:

; 316  :     job->state = THREADQUEUE_JOB_STATE_DONE;

	mov	DWORD PTR [ebx+4], 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 588  :     void notify_one() noexcept { // wake up one waiter

	mov	DWORD PTR __$EHRec$[ebp+8], 1

; 589  :         _Check_C_return(_Cnd_signal(_Mycnd()));

	push	DWORD PTR [esi+8]
	call	DWORD PTR __imp___Cnd_signal
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 590  :     }

	mov	DWORD PTR __$EHRec$[ebp+8], -1
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 323  :     int num_new_jobs = 0;

	mov	DWORD PTR _num_new_jobs$1$[ebp], eax

; 324  :     for (int i = 0; i < job->rdepends_count; ++i) {

	mov	DWORD PTR _i$1$[ebp], eax
	cmp	DWORD PTR [ebx+16], eax
	jle	$LN8@threadqueu
	npad	7
$LL9@threadqueu:

; 325  :       threadqueue_job_t * const depjob = job->rdepends[i];

	lea	ecx, DWORD PTR [eax*4]
	mov	eax, DWORD PTR [ebx+12]
	mov	DWORD PTR tv1080[ebp], ecx
	mov	edi, DWORD PTR [ecx+eax]
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [edi]
	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 330  :       assert(depjob->state == THREADQUEUE_JOB_STATE_WAITING ||

	mov	eax, DWORD PTR [edi+4]
	cmp	eax, 1
	je	SHORT $LN39@threadqueu
	test	eax, eax
	je	SHORT $LN39@threadqueu
	push	331					; 0000014bH
	push	OFFSET $SG4294967059
	push	OFFSET $SG4294967058
	call	DWORD PTR __imp___wassert
	add	esp, 12					; 0000000cH
$LN39@threadqueu:

; 331  :              depjob->state == THREADQUEUE_JOB_STATE_PAUSED);
; 332  :       assert(depjob->ndepends > 0);

	mov	eax, DWORD PTR [edi+8]
	test	eax, eax
	jg	SHORT $LN40@threadqueu
	push	332					; 0000014cH
	push	OFFSET $SG4294967057
	push	OFFSET $SG4294967056
	call	DWORD PTR __imp___wassert
	mov	eax, DWORD PTR [edi+8]
	add	esp, 12					; 0000000cH
$LN40@threadqueu:

; 333  :       depjob->ndepends--;

	add	eax, -1
	mov	DWORD PTR [edi+8], eax

; 334  : 
; 335  :       if (depjob->ndepends == 0 && depjob->state == THREADQUEUE_JOB_STATE_WAITING) {

	jne	SHORT $LN23@threadqueu
	cmp	DWORD PTR [edi+4], 1
	jne	SHORT $LN23@threadqueu

; 531  :   int32_t new_refcount = KVZ_ATOMIC_INC(&job->refcount);

	mov	eax, 1
	lock	 xadd	 DWORD PTR [edi+24], eax
	inc	eax

; 532  :   // The caller should have had another reference and we added one
; 533  :   // reference so refcount should be at least 2.
; 534  :   assert(new_refcount >= 2);

	cmp	eax, 2
	jge	SHORT $LN148@threadqueu
	push	534					; 00000216H
	push	OFFSET $SG4294966990
	push	OFFSET $SG4294966989
	call	DWORD PTR __imp___wassert
	add	esp, 12					; 0000000cH
$LN148@threadqueu:

; 241  :   assert(job->ndepends == 0);

	cmp	DWORD PTR [edi+8], 0
	je	SHORT $LN153@threadqueu
	push	241					; 000000f1H
	push	OFFSET $SG4294967104
	push	OFFSET $SG4294967103
	call	DWORD PTR __imp___wassert
	add	esp, 12					; 0000000cH
$LN153@threadqueu:

; 242  :   job->state = THREADQUEUE_JOB_STATE_READY;

	mov	DWORD PTR [edi+4], 2

; 243  : 
; 244  :   if (threadqueue->first == NULL) //如果没有job转备好

	cmp	DWORD PTR [esi+28], 0
	jne	SHORT $LN150@threadqueu

; 245  :   {
; 246  :     threadqueue->first = job;

	mov	DWORD PTR [esi+28], edi

; 247  :   } 

	jmp	SHORT $LN151@threadqueu
$LN150@threadqueu:

; 248  :   else 
; 249  :   {
; 250  :     threadqueue->last->next = job;//尾插法

	mov	eax, DWORD PTR [esi+32]
	mov	DWORD PTR [eax+36], edi
$LN151@threadqueu:

; 336  :         // Move the job to ready jobs.
; 337  :         threadqueue_push_job(threadqueue, kvz_threadqueue_copy_ref(depjob));
; 338  :         num_new_jobs++;

	inc	DWORD PTR _num_new_jobs$1$[ebp]

; 253  :   threadqueue->last = job;

	mov	DWORD PTR [esi+32], edi

; 254  :   job->next = NULL;

	mov	DWORD PTR [edi+36], 0
$LN23@threadqueu:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [edi]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 343  :       kvz_threadqueue_free_job(&job->rdepends[i]);

	mov	ecx, DWORD PTR [ebx+12]
	add	ecx, DWORD PTR tv1080[ebp]
	call	_kvz_threadqueue_free_job
	mov	eax, DWORD PTR _i$1$[ebp]
	inc	eax
	mov	DWORD PTR _i$1$[ebp], eax
	cmp	eax, DWORD PTR [ebx+16]
	jl	$LL9@threadqueu
$LN8@threadqueu:

; 344  :     }
; 345  :     job->rdepends_count = 0;

	mov	DWORD PTR [ebx+16], 0
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [ebx]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 348  :     kvz_threadqueue_free_job(&job);

	lea	ecx, DWORD PTR _job$2[ebp]
	call	_kvz_threadqueue_free_job

; 352  :     for (int i = 0; i < num_new_jobs - 1; i++) {

	mov	ebx, DWORD PTR _num_new_jobs$1$[ebp]
	xor	edi, edi
	dec	ebx
	test	ebx, ebx
	jle	$LL243@threadqueu
$LL12@threadqueu:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 588  :     void notify_one() noexcept { // wake up one waiter

	mov	DWORD PTR __$EHRec$[ebp+8], 2

; 589  :         _Check_C_return(_Cnd_signal(_Mycnd()));

	push	DWORD PTR [esi+4]
	call	DWORD PTR __imp___Cnd_signal
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	jne	$LN196@threadqueu
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 352  :     for (int i = 0; i < num_new_jobs - 1; i++) {

	inc	edi
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 590  :     }

	mov	DWORD PTR __$EHRec$[ebp+8], -1
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 352  :     for (int i = 0; i < num_new_jobs - 1; i++) {

	cmp	edi, ebx
	jl	SHORT $LL12@threadqueu

; 353  :       pthread_cond_signal(&threadqueue->job_available);
; 354  :     }
; 355  :   }

	jmp	$LL243@threadqueu
$LN187@threadqueu:

; 360  : }

	mov	ecx, DWORD PTR __$EHRec$[ebp]
	xor	eax, eax
	pop	edi
	pop	esi
	mov	DWORD PTR fs:0, ecx
	pop	ebx
	mov	esp, ebp
	pop	ebp
	ret	0
$LN245@threadqueu:
	int	3
	int	3
	int	3
	int	3
	int	3
_TEXT	ENDS
text$x	SEGMENT
__ehhandler$_threadqueue_worker:
	npad	1
	npad	1
	mov	eax, OFFSET __ehfuncinfo$_threadqueue_worker
	jmp	___CxxFrameHandler3
text$x	ENDS
_threadqueue_worker ENDP
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
_kvz_threadqueue_job_dep_add PROC
; _job$ = ecx
; _dependency$ = edx

; 495  : {

	push	ebx
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	mov	ebx, DWORD PTR __imp___Mtx_lock
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 495  : {

	push	esi
	mov	esi, edx
	push	edi
	mov	edi, ecx
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [esi]
	call	ebx
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN20@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN20@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 500  :   if (dependency->state == THREADQUEUE_JOB_STATE_DONE) {

	cmp	DWORD PTR [esi+4], 4
	jne	SHORT $LN3@kvz_thread
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN57@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN3@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [edi]
	call	ebx
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN39@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN39@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [edi]
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 507  :   job->ndepends++;

	inc	DWORD PTR [edi+8]
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	mov	ebx, DWORD PTR __imp___Mtx_unlock
	call	ebx
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN48@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN48@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 511  :   if (dependency->rdepends_count >= dependency->rdepends_size) {

	mov	eax, DWORD PTR [esi+20]
	cmp	DWORD PTR [esi+16], eax
	jl	SHORT $LN7@kvz_thread

; 512  :     dependency->rdepends_size += THREADQUEUE_LIST_REALLOC_SIZE;

	add	eax, 32					; 00000020H
	mov	DWORD PTR [esi+20], eax

; 513  :     size_t bytes = dependency->rdepends_size * sizeof(threadqueue_job_t*);

	shl	eax, 2

; 514  :     dependency->rdepends = realloc(dependency->rdepends, bytes);

	push	eax
	push	DWORD PTR [esi+12]
	call	DWORD PTR __imp__realloc
	add	esp, 8
	mov	DWORD PTR [esi+12], eax
$LN7@kvz_thread:

; 516  :   dependency->rdepends[dependency->rdepends_count++] = kvz_threadqueue_copy_ref(job);

	mov	ecx, edi
	call	_kvz_threadqueue_copy_ref
	mov	edx, DWORD PTR [esi+16]
	mov	ecx, DWORD PTR [esi+12]
	mov	DWORD PTR [ecx+edx*4], eax
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [esi]
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 516  :   dependency->rdepends[dependency->rdepends_count++] = kvz_threadqueue_copy_ref(job);

	inc	DWORD PTR [esi+16]
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	call	ebx
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN57@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN57@kvz_thread:
	pop	edi
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 521  : }

	pop	esi
	mov	eax, 1
	pop	ebx
	ret	0
$LN61@kvz_thread:
_kvz_threadqueue_job_dep_add ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
_kvz_threadqueue_copy_ref PROC
; _job$ = ecx

; 530  : {

	push	esi
	mov	esi, ecx

; 531  :   int32_t new_refcount = KVZ_ATOMIC_INC(&job->refcount);

	mov	eax, 1
	lock	 xadd	 DWORD PTR [esi+24], eax
	inc	eax

; 532  :   // The caller should have had another reference and we added one
; 533  :   // reference so refcount should be at least 2.
; 534  :   assert(new_refcount >= 2);

	cmp	eax, 2
	jge	SHORT $LN4@kvz_thread
	push	534					; 00000216H
	push	OFFSET $SG4294966990
	push	OFFSET $SG4294966989
	call	DWORD PTR __imp___wassert
	add	esp, 12					; 0000000cH
$LN4@kvz_thread:

; 535  :   return job;
; 536  : }

	mov	eax, esi
	pop	esi
	ret	0
_kvz_threadqueue_copy_ref ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
_kvz_threadqueue_free_job PROC
; _job_ptr$ = ecx

; 548  : {

	push	esi

; 549  :   threadqueue_job_t *job = *job_ptr;

	mov	esi, DWORD PTR [ecx]

; 550  :   if (job == NULL) return;

	test	esi, esi
	je	$LN1@kvz_thread

; 551  :   *job_ptr = NULL;

	mov	DWORD PTR [ecx], 0

; 552  : 
; 553  :   int new_refcount = KVZ_ATOMIC_DEC(&job->refcount);

	or	eax, -1
	lock	 xadd	 DWORD PTR [esi+24], eax
	dec	eax

; 554  :   if (new_refcount > 0) {

	test	eax, eax
	jg	SHORT $LN1@kvz_thread

; 555  :     // There are still references so we don't free the data yet.
; 556  :     return;
; 557  :   }
; 558  : 
; 559  :   assert(new_refcount == 0);

	je	SHORT $LN8@kvz_thread
	push	559					; 0000022fH
	push	OFFSET $SG4294966988
	push	OFFSET $SG4294966987
	call	DWORD PTR __imp___wassert
	add	esp, 12					; 0000000cH
$LN8@kvz_thread:

; 560  : 
; 561  :   for (int i = 0; i < job->rdepends_count; i++) {

	push	edi
	xor	edi, edi
	cmp	DWORD PTR [esi+16], edi
	jle	SHORT $LN3@kvz_thread
$LL4@kvz_thread:

; 562  :     kvz_threadqueue_free_job(&job->rdepends[i]);

	mov	eax, DWORD PTR [esi+12]
	lea	ecx, DWORD PTR [eax+edi*4]
	call	_kvz_threadqueue_free_job
	inc	edi
	cmp	edi, DWORD PTR [esi+16]
	jl	SHORT $LL4@kvz_thread
$LN3@kvz_thread:

; 563  :   }
; 564  :   job->rdepends_count = 0;
; 565  : 
; 566  :   FREE_POINTER(job->rdepends);

	push	DWORD PTR [esi+12]
	mov	DWORD PTR [esi+16], 0
	call	DWORD PTR __imp__free
	mov	DWORD PTR [esi+12], 0
	add	esp, 4
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 75   :     delete static_cast<std::mutex*>(*mutex);

	mov	edi, DWORD PTR [esi]
	test	edi, edi
	je	SHORT $LN54@kvz_thread
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 44   :         _Mtx_destroy_in_situ(_Mymtx());

	push	edi
	call	DWORD PTR __imp___Mtx_destroy_in_situ
	push	48					; 00000030H
	push	edi
	call	??3@YAXPAXI@Z				; operator delete
	add	esp, 12					; 0000000cH
$LN54@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 568  :   FREE_POINTER(job);

	push	esi
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 76   :     *mutex = nullptr;

	mov	DWORD PTR [esi], 0
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 568  :   FREE_POINTER(job);

	call	DWORD PTR __imp__free
	add	esp, 4
	pop	edi
$LN1@kvz_thread:

; 569  : }

	pop	esi
	ret	0
_kvz_threadqueue_free_job ENDP
_TEXT	ENDS
; Function compile flags: /Ogtpy
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c
_TEXT	SEGMENT
__$EHRec$ = -12						; size = 12
_kvz_threadqueue_stop PROC
; _threadqueue$ = ecx

; 597  : {

	push	ebp
	mov	ebp, esp
	mov	eax, DWORD PTR fs:0
	push	-1
	push	__ehhandler$_kvz_threadqueue_stop
	push	eax
	mov	DWORD PTR fs:0, esp
	push	ebx
	push	esi
	push	edi
	mov	edi, ecx
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 51   :         _Check_C_return(_Mtx_lock(_Mymtx()));

	push	DWORD PTR [edi]
	call	DWORD PTR __imp___Mtx_lock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN22@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN22@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 600  :   if (threadqueue->stop) {

	cmp	BYTE PTR [edi+24], 0
	je	SHORT $LN6@kvz_thread

; 601  :     // The threadqueue should have stopped already.
; 602  :     assert(threadqueue->thread_running_count == 0);

	cmp	DWORD PTR [edi+20], 0
	je	SHORT $LN13@kvz_thread
	push	602					; 0000025aH
	push	OFFSET $SG4294966969
	push	OFFSET $SG4294966968
	call	DWORD PTR __imp___wassert
	add	esp, 12					; 0000000cH
$LN13@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [edi]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	$LN3@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN6@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 608  :   threadqueue->stop = true;

	mov	BYTE PTR [edi+24], 1
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 592  :     void notify_all() noexcept { // wake up all waiters

	mov	DWORD PTR __$EHRec$[ebp+8], 0

; 593  :         _Check_C_return(_Cnd_broadcast(_Mycnd()));

	push	DWORD PTR [edi+4]
	call	DWORD PTR __imp___Cnd_broadcast
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN42@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN42@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\mutex

; 594  :     }

	mov	DWORD PTR __$EHRec$[ebp+8], -1

; 67   :         _Check_C_return(_Mtx_unlock(_Mymtx()));

	push	DWORD PTR [edi]
	call	DWORD PTR __imp___Mtx_unlock
	add	esp, 4
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\xthreads.h

; 130  :     if (_Res != _Thrd_success) {

	test	eax, eax
	je	SHORT $LN51@kvz_thread

; 131  :         _Throw_C_error(_Res);

	push	eax
	call	DWORD PTR __imp_?_Throw_C_error@std@@YAXH@Z
$LN51@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 613  :   for (int i = 0; i < threadqueue->thread_count; i++) {

	xor	ebx, ebx
	cmp	DWORD PTR [edi+16], ebx
	jle	SHORT $LN3@kvz_thread
	npad	9
$LL4@kvz_thread:
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadwrapper\src\pthread.cpp

; 68   :     std::thread* real_thread = static_cast<std::thread*>(thread);

	mov	eax, DWORD PTR [edi+12]
	mov	esi, DWORD PTR [eax+ebx*4]
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread

; 101  :         return _Thr._Id != 0;

	cmp	DWORD PTR [esi+4], 0

; 105  :         if (!joinable()) {

	je	SHORT $LN77@kvz_thread

; 107  :         }
; 108  : 
; 109  :         if (_Thr._Id == _Thrd_id()) {

	call	DWORD PTR __imp___Thrd_id
	cmp	DWORD PTR [esi+4], eax
	je	SHORT $LN78@kvz_thread

; 111  :         }
; 112  : 
; 113  :         if (_Thrd_join(_Thr, nullptr) != _Thrd_success) {

	push	0
	push	DWORD PTR [esi+4]
	push	DWORD PTR [esi]
	call	DWORD PTR __imp___Thrd_join
	add	esp, 12					; 0000000cH
	test	eax, eax
	jne	SHORT $LN79@kvz_thread
	push	8
	push	esi

; 115  :         }
; 116  : 
; 117  :         _Thr = {};

	mov	DWORD PTR [esi], eax
	mov	DWORD PTR [esi+4], eax
	call	??3@YAXPAXI@Z				; operator delete
; File C:\Users\84038\Desktop\video_codec_thread_test\src\threadqueue.c

; 613  :   for (int i = 0; i < threadqueue->thread_count; i++) {

	inc	ebx
	add	esp, 8
	cmp	ebx, DWORD PTR [edi+16]
	jl	SHORT $LL4@kvz_thread
$LN3@kvz_thread:

; 621  : }

	mov	ecx, DWORD PTR __$EHRec$[ebp]
	mov	eax, 1
	pop	edi
	pop	esi
	mov	DWORD PTR fs:0, ecx
	pop	ebx
	mov	esp, ebp
	pop	ebp
	ret	0
$LN79@kvz_thread:
; File D:\software_install\VS2019\VC\Tools\MSVC\14.26.28801\include\thread

; 114  :             _Throw_Cpp_error(_NO_SUCH_PROCESS);

	push	2
	call	DWORD PTR __imp_?_Throw_Cpp_error@std@@YAXH@Z
$LN78@kvz_thread:

; 110  :             _Throw_Cpp_error(_RESOURCE_DEADLOCK_WOULD_OCCUR);

	push	5
	call	DWORD PTR __imp_?_Throw_Cpp_error@std@@YAXH@Z
$LN77@kvz_thread:

; 106  :             _Throw_Cpp_error(_INVALID_ARGUMENT);

	push	1
	call	DWORD PTR __imp_?_Throw_Cpp_error@std@@YAXH@Z
$LN86@kvz_thread:
	int	3
	int	3
	int	3
	int	3
	int	3
	int	3
_TEXT	ENDS
text$x	SEGMENT
__ehhandler$_kvz_threadqueue_stop:
	npad	1
	npad	1
	mov	eax, OFFSET __ehfuncinfo$_kvz_threadqueue_stop
	jmp	___CxxFrameHandler3
text$x	ENDS
_kvz_threadqueue_stop ENDP
END
